<!DOCTYPE html>
<html>

<head>


    <meta charset="UTF-8">


    <title>10 実行コンテキスト (Execution Contexts)</title>


    <link rel="stylesheet" title="Metagraphix Graytone" type="text/css" href="css/ecma.css" media="all"/>
    <link rel="stylesheet" title="Metagraphix NN4" type="text/javascript" href="js/n4.js" media="screen"/>

    <link rel="bookmark" title="Translator"
          href="mailto:TAKI%20%3Coz-07ams&#64;mvh.biglobe.ne.jp%3E"/>
    <link rel="bookmark" title="Site Top"
          href="http://www2u.biglobe.ne.jp/%7Eoz-07ams/"/>
    <link rel="start begin toc" title="ECMA-262 revision 3"
          href="index.html"/>
    <link rel="prev" title="9_Type_Conversion"
          href="9_Type_Conversion.html"/>
    <link rel="next" title="11_Expressions"
          href="11_Expressions.html"/>

    <link rev="alternate" title="Original Document (PDF format)"
          type="application/pdf" hreflang="en"
          href="http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf"/>


</head>

<body>


<p>
    <a href="#toc">本頁の目次</a>
    <a rel="contents" href="">目次</a>
    <a rel="next" href="11_Expressions.html">次頁: 11_Expressions</a>
    <a rel="prev" href="9_Type_Conversion.html">前頁: 9_Type_Conversion</a>
</p>


<div class="section level1">
    <h1 id="section-10">10 実行コンテキスト (Execution Contexts)</h1>


    <div class="body level1">
        <p>制御が ECMAScript の実行可能コードに転送される時に、制御は <dfn>実行コンテキスト</dfn>
            に入る。アクティブな実行コンテキストは論理的にスタックを形成する。この論理的スタック上の実行コンテキストの頂点が、実行される実行コンテキストである。</p>
    </div>
    <!-- END of 10 Body -->


    <div class="section level2">
        <h2 id="section-10.1">10.1 定義 (Definitions)</h2>


        <div class="section level3">
            <h3 id="section-10.1.1">10.1.1 Function オブジェクト (Function Objects)</h3>


            <div class="body level3">
                <p>Function オブジェクトには 2 種類ある:</p>
                <ul>
                    <li><dfn>プログラム関数</dfn> は、ソーステキスト内に <a
                            href="13_Function_Definition.html#FunctionDeclaration"
                            class="nonterminal">FunctionDeclaration</a> で定義される。あるいは、 <a
                            href="13_Function_Definition.html#FunctionExpression"
                            class="nonterminal">FunctionExpression</a> かコンストラクタとしての組込み <code>Function</code>
                        オブジェクトを使用して動的に生成される。
                    </li>
                    <li><dfn>内部関数</dfn> は、 <code>parseInt</code> や <code>Math.exp</code>
                        のような、言語の組込みオブジェクトである。実装は、本仕様に記述されない実装依存の内部関数を提供してもよい。これらの関数は ECMAScript
                        文法に記述される実行可能コードを含まない。従ってそれらは実行コンテキストのこの議論から除外される。
                    </li>
                </ul>
            </div>
            <!-- END of 10.1.1 Body -->

        </div>
        <!-- END of 10.1.1 -->


        <div class="section level3">
            <h3 id="section-10.1.2">10.1.2 実行可能コードの種類 (Types of Executable Code)</h3>


            <div class="body level3">
                <p>ECMAScript の実行可能コードの種類は 3 つある:</p>
                <ul>
                    <li><dfn>グローバルコード</dfn> は ECMAScript の <a
                            href="14_Program.html#Program"
                            class="nonterminal">Program</a> として扱われるソーステキストである。個々の <a
                            href="14_Program.html#Program"
                            class="nonterminal">Program</a> のグローバルコードは <a
                            href="13_Function_Definition.html#FunctionBody"
                            class="nonterminal">FunctionBody</a> 部分として解析されるソーステキストを含まない。
                    </li>
                    <li><dfn>eval コード</dfn> は組込み eval 関数に提供されるソーステキストである。より正確には、組込み eval 関数のパラメータが文字列なら、それは ECMAScript の
                        <a href="14_Program.html#Program"
                           class="nonterminal">Program</a> として扱われる。個々の eval 呼び出しのための eval コードは、文字列パラメータのグローバルコード部分である。
                    </li>
                    <li><dfn>関数コード</dfn> は <a
                            href="13_Function_Definition.html#FunctionBody"
                            class="nonterminal">FunctionBody</a> 部分として解析されるソーステキストである。個々の <a
                            href="13_Function_Definition.html#FunctionBody"
                            class="nonterminal">FunctionBody</a> の関数コードは、ネストされた <a
                            href="13_Function_Definition.html#FunctionBody"
                            class="nonterminal">FunctionBody</a> 部分として解析されるソーステキストを含まない。関数コードはまた、コンストラクタとして組込み Function
                        オブジェクトを使用する際提供されるソーステキストもあらわす。より正確には、 Function コンストラクタに提供される最後のパラメータは文字列に変換され <a
                                href="13_Function_Definition.html#FunctionBody"
                                class="nonterminal">FunctionBody</a> として扱われる。 Function
                        コンストラクタにひとつ以上のパラメータが供給されれば、最後の一つを除いた残りのパラメータすべてが文字列に変換され、カンマを区切りに連結される。その結果の文字列は最後のパラメータで定義される
                        <a href="13_Function_Definition.html#FunctionBody"
                           class="nonterminal">FunctionBody</a> のための <a
                                href="13_Function_Definition.html#FormalParameterList"
                                class="nonterminal">FormalParameterList</a> として解釈される。 Function
                        の個々のインスタンス化のための関数コードはネストされた <a
                                href="13_Function_Definition.html#FunctionBody"
                                class="nonterminal">FunctionBody</a> 部分として解析されるソーステキストを含まない。
                    </li>
                </ul>
            </div>
            <!-- END of 10.1.2 Body -->

        </div>
        <!-- END of 10.1.2 -->


        <div class="section level3">
            <h3 id="section-10.1.3">10.1.3 変数の実体化 (Variable Instantiation)</h3>


            <div class="body level3">
                <p>各実行コンテキストは <dfn>変数オブジェクト (variable object)</dfn>
                    に結び付けられている。ソーステキスト内に宣言された変数と関数は変数オブジェクトのプロパティに追加される。関数コードについては、パラメータが変数オブジェクトのプロパティに追加される。</p>

                <p>
                    どのオブジェクトが変数オブジェクトに使われるか、どの属性がプロパティに使われるかは、コードの型に依存する。しかし、後の振る舞いは総括的である。実行コンテキストに入ると、プロパティは次の順に変数オブジェクトに結び付けられる:</p>
                <ul>
                    <li>関数コードでは: <a
                            href="13_Function_Definition.html#FormalParameterList"
                            class="nonterminal">FormalParameterList</a> で定義された仮引数ごとに、変数オブジェクトにプロパティを生成する。その名前は <a
                            href="7_Lexical_Conventions.html#Identifier"
                            class="nonterminal">Identifier</a> で、属性はコード型によって決定する。パラメータ値は呼出側によって [[Call]]
                        の引数として供給される。呼出側が仮引数より少ないパラメータ値を供給するならば、余分な仮引数は値 undefined を持つ。 2
                        つ以上の仮引数が同じ名前のために同じプロパティを共有する場合、該当するプロパティは、後出のパラメータに供給された値を与えられる。この後出のパラメータ値が呼出側から供給されない場合、該当するプロパティの値は
                        undefined である。
                    </li>
                    <li>ソーステキスト順で、コード中の各 <a
                            href="13_Function_Definition.html#FunctionDeclaration"
                            class="nonterminal">FunctionDeclaration</a> 毎に、変数オブジェクトにプロパティを生成する。その名前は <a
                            href="13_Function_Definition.html#FunctionDeclaration"
                            class="nonterminal">FunctionDeclaration</a> の <a
                            href="7_Lexical_Conventions.html#Identifier"
                            class="nonterminal">Identifier</a> で、値には<a href="13_Function_Definition.html#section-13">セクション
                        13</a> に記述される Function
                        オブジェクトの生成で返される結果が設定され、属性はコードの型によって決定する。変数オブジェクトが既にこの名前のプロパティを持っている場合、その値と属性を置換する。意味論的に、このステップは
                        <a href="13_Function_Definition.html#FormalParameterList"
                           class="nonterminal">FormalParameterList</a> プロパティの生成に続かなければならない。
                    </li>
                    <li>コード中の各 <a
                            href="12_Statements.html#VariableDeclaration"
                            class="nonterminal">VariableDeclaration</a> あるいは <a
                            href="12_Statements.html#VariableDeclarationNoIn"
                            class="nonterminal">VariableDeclarationNoIn</a> 毎に、変数オブジェクトにプロパティを生成する。その名前は <a
                            href="12_Statements.html#VariableDeclaration"
                            class="nonterminal">VariableDeclaration</a> または <a
                            href="12_Statements.html#VariableDeclarationNoIn"
                            class="nonterminal">VariableDeclarationNoIn</a> 中の <a
                            href="7_Lexical_Conventions.html#Identifier"
                            class="nonterminal">Identifier</a> で、値は undefined
                        、属性はコードの型により決定する。変数オブジェクトが既にこの名前のプロパティを持っている場合、プロパティの値と属性は変更されない。意味論的に、このステップは <a
                                href="13_Function_Definition.html#FormalParameterList"
                                class="nonterminal">FormalParameterList</a> と <a
                                href="13_Function_Definition.html#FunctionDeclaration"
                                class="nonterminal">FunctionDeclaration</a>
                        のプロパティ生成に続かなければならない。宣言される変数が、宣言された関数や仮引数と同じ名前を持っている場合、変数宣言は特に既存のプロパティを妨害しない。
                    </li>
                </ul>
            </div>
            <!-- END of 10.1.3 Body -->

        </div>
        <!-- END of 10.1.3 -->


        <div class="section level3">
            <h3 id="section-10.1.4">10.1.4 スコープ連鎖と識別子の解決 (Scope Chain and Identifier Resolution)</h3>


            <div class="body level3">
                <p>各実行コンテキストは <dfn>スコープ連鎖 (scope chain)</dfn> に関連付けられている。スコープ連鎖はオブジェクトのリストで、Identifier
                    の評価の際に検索される。制御が実行コンテキストに入るとき、コード型毎にオブジェクト集合の初期値を伴うスコープ連鎖が生成され、組み込まれる。実行コンテキスト内における実行の間、実行コンテキストのスコープ連鎖は
                    <code class="keyword">with</code> 文(<a href="12_Statements.html#section-12.10">12.10</a>) と <code
                            class="keyword">catch</code> クローズ(<a href="12_Statements.html#section-12.14">12.14</a>)
                    によってのみ影響を及ぼされる。</p>

                <p>実行中、構文的生成規則 <a
                        href="11_Expressions.html#PrimaryExpression"
                        class="nonterminal">PrimaryExpression</a> : <a
                        href="7_Lexical_Conventions.html#Identifier"
                        class="nonterminal">Identifier</a> は次のアルゴリズムで評価される:</p>
                <ol>
                    <li>スコープ連鎖内で次のオブジェクトを取得する。一つもなければ、ステップ 5ヘ。</li>
                    <li>Result(1) の [[HasProperty]] メソッドを呼び、プロパティとして <a
                            href="7_Lexical_Conventions.html#Identifier"
                            class="nonterminal">Identifier</a> を渡す。
                    </li>
                    <li>Result(2) が true ならば、基準オブジェクトが Result(1) でプロパティ名が <a
                            href="7_Lexical_Conventions.html#Identifier"
                            class="nonterminal">Identifier</a> である Reference 型の値を返す。
                    </li>
                    <li>ステップ 1 へ。</li>
                    <li>基準オブジェクトが null でプロパティ名が <a
                            href="7_Lexical_Conventions.html#Identifier"
                            class="nonterminal">Identifier</a> である Reference 型の値を返す。
                    </li>
                </ol>
                <p>識別子評価の結果は常に、識別子文字列と等しいメンバ名成分を持つ Reference 型の値である。</p>
            </div>
            <!-- END of 10.1.4 Body -->

        </div>
        <!-- END of 10.1.4 -->


        <div class="section level3">
            <h3 id="section-10.1.5">10.1.5 Global オブジェクト (Global Object)</h3>


            <div class="body level3">
                <p>制御が任意の実行コンテキストに入る前に生成される、一意的な <dfn>グローバルオブジェクト</dfn> (セクション15.1) が存在する。最初はグローバルオブジェクトは次のプロパティを持つ:</p>
                <ul>
                    <li>Math, String, Date, parseInt 等のような組込みオブジェクト。これらは属性 { DontEnum } を持つ。</li>
                    <li>ホストの定義する追加プロパティ。これはグローバルオブジェクト自身を値とするプロパティを含めてよい; たとえば、HTML 文書オブジェクトモデルにおけるグローバルオブジェクトの window
                        プロパティは、グローバルオブジェクトそれ自身である。
                    </li>
                </ul>
                <p>制御が実行コンテキストに入り、ECMAScript コードが実行されれば、グローバルオブジェクトに追加プロパティを追加しても、初期のプロパティを変更してもよい。</p>
            </div>
            <!-- END of 10.1.5 Body -->

        </div>
        <!-- END of 10.1.5 -->


        <div class="section level3">
            <h3 id="section-10.1.6">10.1.6 Activation オブジェクト (Activation Object)</h3>


            <div class="body level3">
                <p>関数コードによって制御が実行コンテキストに入るとき、 Activation オブジェクトと呼ばれるオブジェクトが生成され実行コンテキストに結び付けられる。 Activation オブジェクトは属性 {
                    DontDelete } のプロパティ arguments で初期化される。このプロパティの初期値は下に述べる arguments オブジェクトである。</p>

                <p>Activation オブジェクトは変数の実体化を目的とした変数オブジェクトとして使用される。</p>

                <p>Activation オブジェクトは純粋に仕様のメカニズムである。 Activation オブジェクトへのアクセスは ECMAScript プログラムには不可能である。 Activation
                    オブジェクトのメンバへのアクセスは可能だが、 Activation オブジェクト自身へのアクセスはできない。基準オブジェクトが Activation オブジェクトである Reference
                    値に呼出操作が適用されるとき、その呼出の <code class="keyword">this</code> 値として null が使われる。</p>
            </div>
            <!-- END of 10.1.6 Body -->

        </div>
        <!-- END of 10.1.6 -->


        <div class="section level3">
            <h3 id="section-10.1.7">10.1.7 this</h3>


            <div class="body level3">
                <p>アクティブな実行コンテキストそれぞれに結び付けられる <code class="keyword">this</code> 値がある。<var>this</var>
                    値は呼出側と実行されるコード型に依存し、制御が実行コンテキストに入るときに決定される。実行コンテキストに結び付けられる <code class="keyword">this</code>
                    値は不変である。</p>
            </div>
            <!-- END of 10.1.7 Body -->

        </div>
        <!-- END of 10.1.7 -->


        <div class="section level3">
            <h3 id="section-10.1.8">10.1.8 arguments オブジェクト (Arguments Object)</h3>


            <div class="body level3">
                <p>関数コードによって制御が実行コンテキストに入るとき、 <var>arguments</var> オブジェクトが作成され次のように初期化される:</p>
                <ul>
                    <li>argument オブジェクトの内部 [[Prototype]] プロパティの値は、オリジナルの Object prototype オブジェクトで、 Object.prototype
                        (セクション15.2.3.1) の初期値である。
                    </li>
                    <li>属性 { DontEnum } のプロパティ callee を作成する。このプロパティの初期値は実行されている Function
                        オブジェクトである。これは再帰する匿名ファンクションを許す。
                    </li>
                    <li>属性 { DontEnum } のプロパティ length を作成する。このプロパティの初期値は呼出側から供給された実際のパラメータの数である。</li>
                    <li>0 以上 length プロパティの値未満の整数 arg それぞれについて、属性 { DontEnum } のプロパティ ToString(arg)
                        が作成される。このプロパティの初期値は対応するパラメータの呼出側に供給される実際の値である。最初の実際のパラメータ値が arg = 0、2 番目は arg = 1, 以下同様である。arg が
                        Function オブジェクトの仮引数の数より小さい場合、このプロパティは Activation オブジェクトの対応するプロパティとその値を共有する。このことは、このプロパティの変更が
                        Activation オブジェクトの対応するプロパティを変更すること、そしてその逆を意味する。
                    </li>
                </ul>
            </div>
            <!-- END of 10.1.8 Body -->

        </div>
        <!-- END of 10.1.8 -->

    </div>
    <!-- END of 10.1 -->


    <div class="section level2">
        <h2 id="section-10.2">10.2 実行コンテキストの開始 (Entering An Execution Context)</h2>


        <div class="body level2">
            <p>
                各関数とコンストラクタの呼出は、新しい実行コンテキストを開始する。関数がそれ自身の再帰的呼出であっても、各リターンは実行コンテキストを終了する。投げられた例外が受け取られない場合は、一つ以上の実行コンテキストを終了してよい。</p>

            <p>制御が実行コンテキストを開始するとき、スコープ連鎖が生成・初期化され、変数の実体化が行われ、this 値が決定される。</p>

            <p>スコープ連鎖の実体化、変数の実体化、this 値の決定は、開始するコード型に依存する。</p>
        </div>
        <!-- END of 10.2 Body -->


        <div class="section level3">
            <h3 id="section-10.2.1">10.2.1 グローバルコード (Global Code)</h3>


            <div class="body level3">
                <ul>
                    <li>スコープ連鎖が作成され、グローバルオブジェクトのみの構成で初期化される。</li>
                    <li>変数の実体化が行われ、変数オブジェクトにグローバルオブジェクト、プロパティ属性 { DontDelete } が用いられる。</li>
                    <li><code class="keyword">this</code> 値はグローバルオブジェクトである。</li>
                </ul>
            </div>
            <!-- END of 10.2.1 Body -->

        </div>
        <!-- END of 10.2.1 -->


        <div class="section level3">
            <h3 id="section-10.2.2">10.2.2 Eval コード (Eval Code)</h3>


            <div class="body level3">
                <p>制御が eval コードの実行コンテキストを開始するとき、前のアクティブな実行コンテキストは、 <dfn>呼出コンテキスト</dfn> として参照され、スコープ連鎖、変数オブジェクト、 <code
                        class="keyword">this</code> 値の決定に使用される。呼出コンテキストがなければ、スコープ連鎖、変数の実体化、this
                    値の決定の初期化は、グローバルコードとして行われる。</p>
                <ul>
                    <li>スコープ連鎖が初期化され、呼出コンテキストのスコープ連鎖と同じオブジェクト、同じ順序になるように構成される。これは <code class="keyword">with</code>
                        宣言および <code class="keyword">catch</code> クローズによって呼出コンテキストのスコープ連鎖に追加されるオブジェクトを含む。
                    </li>
                    <li>変数の実体化が行われ、呼出コンテキストの変数オブジェクト、プロパティ属性 { } が用られる。</li>
                    <li><code class="keyword">this</code> 値は呼出コンテキストの <code class="keyword">this</code> 値と同じである。</li>
                </ul>
            </div>
            <!-- END of 10.2.2 Body -->

        </div>
        <!-- END of 10.2.2 -->


        <div class="section level3">
            <h3 id="section-10.2.3">10.2.3 関数コード (Function Code)</h3>


            <div class="body level3">
                <ul>
                    <li>スコープ連鎖が初期化され、 Activation オブジェクトに Function オブジェクトの [[Scope]]
                        プロパティに蓄積されたスコープ連鎖内のオブジェクトが続くように構成される。
                    </li>
                    <li>変数の実体化が行われ、変数オブジェクトに Activation オブジェクト、プロパティ属性 { DontDelete } が用いられる。</li>
                    <li><code class="keyword">this</code> 値は呼出側が提供する。呼出側が提供する <code class="keyword">this</code>
                        値がオブジェクトでない場合(null である場合を含む)、 <code class="keyword">this</code> 値はグローバルオブジェクトとする。
                    </li>
                </ul>
            </div>
            <!-- END of 10.2.3 Body -->

        </div>
        <!-- END of 10.2.3 -->

    </div>
    <!-- END of 10.2 -->

</div>
<!-- END of 10 -->

<h1>Page Contents</h1>
<ul id="toc">
    <li><a href="#section-10">10 実行コンテキスト (Execution Contexts)</a>
        <ul>
            <li><a href="#section-10.1">10.1 定義 (Definitions)</a>
                <ul>
                    <li><a href="#section-10.1.1">10.1.1 Function オブジェクト (Function Objects)</a></li>
                    <li><a href="#section-10.1.2">10.1.2 実行可能コードの種類 (Types of Executable Code)</a></li>
                    <li><a href="#section-10.1.3">10.1.3 変数の実体化 (Variable Instantiation)</a></li>
                    <li><a href="#section-10.1.4">10.1.4 スコープ連鎖と識別子の解決 (Scope Chain and Identifier Resolution)</a></li>
                    <li><a href="#section-10.1.5">10.1.5 Global オブジェクト (Global Object)</a></li>
                    <li><a href="#section-10.1.6">10.1.6 Activation オブジェクト (Activation Object)</a></li>
                    <li><a href="#section-10.1.7">10.1.7 this</a></li>
                    <li><a href="#section-10.1.8">10.1.8 arguments オブジェクト (Arguments Object)</a></li>
                </ul>
            </li>
            <li><a href="#section-10.2">10.2 実行コンテキストの開始 (Entering An Execution Context)</a>
                <ul>
                    <li><a href="#section-10.2.1">10.2.1 グローバルコード (Global Code)</a></li>
                    <li><a href="#section-10.2.2">10.2.2 Eval コード (Eval Code)</a></li>
                    <li><a href="#section-10.2.3">10.2.3 関数コード (Function Code)</a></li>
                </ul>
            </li>
        </ul>
    </li>
</ul>

<address>

    Translate: <span>Wed Jun 19 18:25:30 2002</span>

<span>TAKI &lt;<a rel="bookmark" title="Translator"
                  href="mailto:TAKI%20%3Coz-07ams@mvh.biglobe.ne.jp%3E"
        >oz-07ams&#64;mvh.biglobe.ne.jp</a>&gt;</span>

</address>

</body>

</html>


<!--
     FILE ARCHIVED ON 16:52:55 Jul 28, 2014 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 16:14:48 Feb 6, 2015.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
